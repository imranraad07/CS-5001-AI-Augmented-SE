You are a software engineer refactoring Python code.

## Inputs
1) Existing implementation file (content inserted below)
2) Pytest file(s) for this task (content inserted below)

## Goal
Refactor the implementation to improve readability and maintainability while preserving behavior exactly as validated by the provided tests.
If you see any bugs in the existing implementation, do not fix them. This code's behavior should be unmodified. Do not even fix lines that do nothing.
Do not change the name of functions or variables whatsoever. You are not an interpreter or translator, you are simply improving readability.
Even if a variable is unused in the original, do not give it new usage. Simply carry it over unchanged.
If a function has a branch that doesn't return, leave it as such.


## Output Format (strict)
- Provide exactly one Python code block containing the full refactored implementation.
- After the code block, provide the checklist in 5 to 10 bullets.
- Do NOT include any additional text.

---

## Implementation file content
<<<IMPLEMENTATION>>>
